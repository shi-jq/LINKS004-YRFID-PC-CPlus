#include "StdAfx.h"
#include "ErrorProcess.h"
#include "Global.h"



CErrorProcess::CErrorProcess()
{
	errorCode = 0;
}

CErrorProcess::~CErrorProcess(void)
{
}

//////////////////////////////////////////////////////////////////////////
//函数名:	获取出错代码
//参数说明:	无
//返回值:	出错代码
//////////////////////////////////////////////////////////////////////////
int CErrorProcess::GetErrorCode ()
{
	return errorCode;
}

//////////////////////////////////////////////////////////////////////////
//函数名:	设置出错代码
//参数说明:	iErrorCode 出错代码
//返回值:	无
//////////////////////////////////////////////////////////////////////////
void CErrorProcess::SetErrorCode (int iErrorCode, bool isComError )
{
	if ( iErrorCode != 0 )		//保存第1次出现错误的地方, 即出栈以后的错误不再加进来
	{
		errorCode = iErrorCode;
		isCommandError = isComError;
	}
}

//////////////////////////////////////////////////////////////////////////
//函数名:	获取出错信息
//参数说明:	strError 返回出错string信息
//返回值:	无
//////////////////////////////////////////////////////////////////////////
void CErrorProcess::GetErrorMsg (string strType,string& strError)
{
	msgError.GetErrorMessage(strType,errorCode,strError);
}


//////////////////////////////////////////////////////////////////////////
//函数名:	清除出错信息
//参数说明:	无
//返回值:	无
//////////////////////////////////////////////////////////////////////////
void CErrorProcess::ClearErrorCode()
{
	errorCode = 0;
}